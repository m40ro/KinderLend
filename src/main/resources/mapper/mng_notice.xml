<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--반드시 세미콜론 생략 -->
<mapper
        namespace="com.tenco.toyproject.repository.interfaces.mng.board.MngNoticeRepository">



    <select id="findAllNoticeWithPagenaition">
        SELECT * FROM board b JOIN user u ON b.user_id = u.id where code = 1 LIMIT #{start}, 5
    </select>
<!--    &lt;!&ndash; 물품 상세 &ndash;&gt;-->
<!--    <select id="findProductById" resultType="com.tenco.toyproject.repository.entity.Product">-->
<!--        SELECT p.id, p.first_category_id, p.second_category_id, p.price, p.name, p.pic_url, p.content, p.status, p.created_at, p.grade, fc.first_category_name, sc.second_category_name FROM product AS p-->
<!--                                                                                                                                                                                                 JOIN first_category AS fc ON fc.id = p.first_category_id-->
<!--                                                                                                                                                                                                 JOIN second_category AS sc ON sc.id = p.second_category_id-->
<!--        WHERE p.id = #{pId}-->
<!--    </select>-->
    <!-- 물품 건수 -->
    <select id="countNotice" resultType="int">
        SELECT count(*) FROM product
    </select>

    <!-- FAQ LIST -->
    <select id="countFaq" resultType="int">
        SELECT COUNT(*) AS count FROM board WHERE code = 2
    </select>

    <!-- FAQ 조회 -->
    <select id="findAllFaqWithPagenation" resultType="com.tenco.toyproject.repository.entity.Board">
        SELECT * FROM board where code = 2 LIMIT #{start}, 5
    </select>

    <!-- QnA 조회 -->
    <select id="findQnaByCodeWithPagenation" resultType="com.tenco.toyproject.repository.entity.Board">
        SELECT b.id, b.title, b.code, b.user_id, b.created_at, (r.id IS NOT NULL) AS reply  FROM board AS b
        LEFT JOIN reply AS r ON r.board_id = b.id
        WHERE b.code = #{code}
            LIMIT #{start}, 5
    </select>

    <!-- 게시글 삭제 -->
    <delete id="deleteBoardById">
        DELETE FROM board WHERE id = #{id}
    </delete>

    <!-- FAQ 등록 -->
    <insert id="createFaq">
        INSERT INTO board (title, content, code, created_at) VALUES (#{title}, #{content}, #{code}, NOW())
    </insert>

    <!-- id로 게시글 조회 -->
    <select id="findBoardById" resultType="com.tenco.toyproject.repository.entity.Board">
        SELECT * FROM board WHERE id = #{id}
    </select>

    <!-- id로 게시글 수정 -->
    <update id="updateFaqById">
        UPDATE board SET title = #{title}, content = #{content} WHERE id = #{id}
    </update>



</mapper>